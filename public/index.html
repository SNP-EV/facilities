<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®¾å¤‡è®¾æ–½ç®¡ç†ç³»ç»Ÿ</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1e5799 0%, #207cca 100%);
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .data-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .data-btn {
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .data-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .buildings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .building-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .building-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .building-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: #1e5799;
        }
        
        .building-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .building-desc {
            font-size: 14px;
            color: #666;
        }
        
        .page {
            display: none;
        }
        
        .active {
            display: block;
        }
        
        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-btn:hover {
            background: #5a6268;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .page-title {
            font-size: 24px;
            color: #1e5799;
        }
        
        .add-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        
        .add-btn:hover {
            background: #218838;
        }
        
        .floor-list, .equipment-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .floor-card, .equipment-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid #1e5799;
        }
        
        .floor-card:hover, .equipment-card:hover {
            background: #f0f8ff;
            transform: translateY(-2px);
        }
        
        .floor-name, .equipment-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #1e5799;
        }
        
        .floor-desc, .equipment-desc {
            font-size: 14px;
            color: #666;
        }
        
        .equipment-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: #888;
        }
        
        .equipment-detail {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .detail-title {
            font-size: 22px;
            color: #1e5799;
        }
        
        .detail-status {
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        
        .detail-section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #333;
            border-left: 4px solid #1e5799;
            padding-left: 10px;
        }
        
        .param-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .param-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
        }
        
        .param-name {
            font-weight: bold;
        }
        
        .maintenance-record {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .record-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .record-date {
            font-weight: bold;
        }
        
        .record-person {
            color: #666;
        }
        
        .record-content {
            font-size: 14px;
        }
        
        .add-record-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        .add-record-btn:hover {
            background: #218838;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            width: 90%;
            max-width: 500px;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-title {
            font-size: 20px;
            color: #1e5799;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn-primary {
            background: #1e5799;
            color: white;
        }
        
        .btn-primary:hover {
            background: #16457a;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            grid-column: 1 / -1;
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ccc;
        }
        
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        .loading.active {
            display: flex;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1e5799;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .buildings-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .floor-list, .equipment-list {
                grid-template-columns: 1fr;
            }
            
            .param-grid {
                grid-template-columns: 1fr;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .data-controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div>å¤„ç†ä¸­...</div>
    </div>

    <div class="container">
        <!-- é¦–é¡µ - æ¥¼å®‡é€‰æ‹© -->
        <div id="home-page" class="page active">
            <header>
                <h1>è®¾å¤‡è®¾æ–½ç®¡ç†ç³»ç»Ÿ</h1>
                <p class="subtitle">é€‰æ‹©æ¥¼å®‡æŸ¥çœ‹è®¾å¤‡è®¾æ–½ä¿¡æ¯</p>
                <div class="data-controls">
                    <button class="data-btn" onclick="exportToExcel()">ğŸ“Š å¯¼å‡ºExcel</button>
                    <label class="data-btn">
                        ğŸ“¥ å¯¼å…¥Excel
                        <input type="file" accept=".xlsx,.xls" onchange="importFromExcel(this)" style="display: none;">
                    </label>
                    <button class="data-btn" onclick="exportToJSON()">ğŸ’¾ å¯¼å‡ºJSON</button>
                    <label class="data-btn">
                        ğŸ“ å¯¼å…¥JSON
                        <input type="file" accept=".json" onchange="importFromJSON(this)" style="display: none;">
                    </label>
                </div>
            </header>
            
            <div class="buildings-grid">
                <!-- å…«ä¸ªæ¥¼å®‡å¡ç‰‡ -->
                <div class="building-card" data-building="1">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">1å·æ¥¼</div>
                    <div class="building-desc">ä¸»åŠå…¬æ¥¼ - 5å±‚ + å±‹é¡¶</div>
                </div>
                
                <div class="building-card" data-building="2">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">2å·æ¥¼</div>
                    <div class="building-desc">æ¶ˆé˜²ä¸å·¥ç¨‹æ¥¼</div>
                </div>
                
                <div class="building-card" data-building="3">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">3å·æ¥¼</div>
                    <div class="building-desc">é¤å… - 2å±‚</div>
                </div>
                
                <div class="building-card" data-building="4">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">4å·æ¥¼</div>
                    <div class="building-desc">ä¸­æ§ä¸é…ç”µå®¤</div>
                </div>
                
                <div class="building-card" data-building="5">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">5å·æ¥¼</div>
                    <div class="building-desc">åº“æˆ¿ä¸è§£æå®¤</div>
                </div>
                
                <div class="building-card" data-building="6">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">6å·æ¥¼</div>
                    <div class="building-desc">åº“æˆ¿ä¸å±åºŸé—´</div>
                </div>
                
                <div class="building-card" data-building="7">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">7å·æ¥¼</div>
                    <div class="building-desc">äºŒæ¬¡è’¸æ±½å®¤</div>
                </div>
                
                <div class="building-card" data-building="8">
                    <div class="building-icon">ğŸ¢</div>
                    <div class="building-name">8å·æ¥¼</div>
                    <div class="building-desc">è¥¿é—¨å«</div>
                </div>
                
                <div class="building-card" data-building="outdoor">
                    <div class="building-icon">ğŸŒ³</div>
                    <div class="building-name">å®¤å¤–åŒºåŸŸ</div>
                    <div class="building-desc">å†·å´å¡”ã€è·¯ç¯ã€å……ç”µæ¡©ç­‰</div>
                </div>
            </div>
        </div>
        
        <!-- æ¥¼å±‚/åŒºåŸŸé€‰æ‹©é¡µé¢ -->
        <div id="floor-page" class="page">
            <button class="back-btn" onclick="goBack('floor-page', 'home-page')">
                â† è¿”å›æ¥¼å®‡åˆ—è¡¨
            </button>
            <div class="page-header">
                <h2 class="page-title" id="building-title">æ¥¼å®‡åç§°</h2>
                <button class="add-btn" onclick="openAddFloorModal()">
                    + æ·»åŠ æ¥¼å±‚/åŒºåŸŸ
                </button>
            </div>
            <div class="floor-list" id="floor-list">
                <!-- æ¥¼å±‚/åŒºåŸŸå¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- è®¾å¤‡åˆ—è¡¨é¡µé¢ -->
        <div id="equipment-page" class="page">
            <button class="back-btn" onclick="goBack('equipment-page', 'floor-page')">
                â† è¿”å›æ¥¼å±‚åˆ—è¡¨
            </button>
            <div class="page-header">
                <h2 class="page-title" id="floor-title">æ¥¼å±‚/åŒºåŸŸåç§°</h2>
                <button class="add-btn" onclick="openAddEquipmentModal()">
                    + æ·»åŠ è®¾å¤‡
                </button>
            </div>
            <div class="equipment-list" id="equipment-list">
                <!-- è®¾å¤‡å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- è®¾å¤‡è¯¦æƒ…é¡µé¢ -->
        <div id="detail-page" class="page">
            <button class="back-btn" onclick="goBack('detail-page', 'equipment-page')">
                â† è¿”å›è®¾å¤‡åˆ—è¡¨
            </button>
            <div class="equipment-detail" id="equipment-detail">
                <!-- è®¾å¤‡è¯¦æƒ…å†…å®¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>
    
    <!-- æ·»åŠ æ¥¼å±‚/åŒºåŸŸæ¨¡æ€æ¡† -->
    <div id="add-floor-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ æ¥¼å±‚/åŒºåŸŸ</h3>
                <button class="close-btn" onclick="closeAddFloorModal()">&times;</button>
            </div>
            <form id="add-floor-form">
                <div class="form-group">
                    <label class="form-label">åç§°</label>
                    <input type="text" class="form-input" id="floor-name" required placeholder="ä¾‹å¦‚ï¼šåœ°ä¸‹åˆ¶å†·æœºæˆ¿">
                </div>
                <div class="form-group">
                    <label class="form-label">æè¿°</label>
                    <textarea class="form-textarea" id="floor-description" placeholder="ç®€è¦æè¿°è¯¥åŒºåŸŸçš„åŠŸèƒ½æˆ–ç‰¹ç‚¹"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddFloorModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- æ·»åŠ è®¾å¤‡æ¨¡æ€æ¡† -->
    <div id="add-equipment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ æ–°è®¾å¤‡</h3>
                <button class="close-btn" onclick="closeAddEquipmentModal()">&times;</button>
            </div>
            <form id="add-equipment-form">
                <div class="form-group">
                    <label class="form-label">è®¾å¤‡åç§°</label>
                    <input type="text" class="form-input" id="equipment-name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">è®¾å¤‡å‹å·</label>
                    <input type="text" class="form-input" id="equipment-model">
                </div>
                <div class="form-group">
                    <label class="form-label">è®¾å¤‡æè¿°</label>
                    <textarea class="form-textarea" id="equipment-description"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">åŠŸç‡</label>
                    <input type="text" class="form-input" id="equipment-power">
                </div>
                <div class="form-group">
                    <label class="form-label">åˆ¶é€ å•†</label>
                    <input type="text" class="form-input" id="equipment-manufacturer">
                </div>
                <div class="form-group">
                    <label class="form-label">ç»´æŠ¤å‘¨æœŸ</label>
                    <select class="form-input" id="equipment-maintenance-schedule">
                        <option value="æ¯æœˆä¸€æ¬¡">æ¯æœˆä¸€æ¬¡</option>
                        <option value="æ¯å­£åº¦ä¸€æ¬¡">æ¯å­£åº¦ä¸€æ¬¡</option>
                        <option value="æ¯åŠå¹´ä¸€æ¬¡">æ¯åŠå¹´ä¸€æ¬¡</option>
                        <option value="æ¯å¹´ä¸€æ¬¡">æ¯å¹´ä¸€æ¬¡</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddEquipmentModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜è®¾å¤‡</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- æ·»åŠ ç»´æŠ¤è®°å½•æ¨¡æ€æ¡† -->
    <div id="record-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">æ·»åŠ ç»´æŠ¤è®°å½•</h3>
                <button class="close-btn" onclick="closeRecordModal()">&times;</button>
            </div>
            <form id="record-form">
                <div class="form-group">
                    <label class="form-label">ç»´æŠ¤æ—¥æœŸ</label>
                    <input type="date" class="form-input" id="record-date" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ç»´æŠ¤äººå‘˜</label>
                    <input type="text" class="form-input" id="record-person" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ç»´æŠ¤å†…å®¹</label>
                    <textarea class="form-textarea" id="record-content" required></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ä¸‹æ¬¡ç»´æŠ¤æ—¶é—´</label>
                    <input type="date" class="form-input" id="next-maintenance">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeRecordModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¿å­˜è®°å½•</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿæ•°æ® - åœ¨å®é™…åº”ç”¨ä¸­åº”ä»åç«¯APIè·å–
        let buildingData = {
            "1": {
                name: "1å·æ¥¼",
                floors: [
                    { id: "1-1", name: "åœ°ä¸‹åˆ¶å†·æœºæˆ¿", description: "ä¸­å¤®ç©ºè°ƒåˆ¶å†·è®¾å¤‡" },
                    { id: "1-2", name: "ä¸€å±‚", description: "åŠå…¬åŒºä¸æ¥å¾…åŒº" },
                    { id: "1-3", name: "ä¸€å¤¹å±‚", description: "è®¾å¤‡é—´ä¸å‚¨è—å®¤" },
                    { id: "1-4", name: "äºŒå±‚", description: "åŠå…¬åŒºä¸ä¼šè®®å®¤" },
                    { id: "1-5", name: "äºŒå¤¹å±‚", description: "æ¡£æ¡ˆå®¤ä¸è®¾å¤‡é—´" },
                    { id: "1-6", name: "å±‹é¡¶", description: "é€šé£è®¾å¤‡ä¸å¤ªé˜³èƒ½æ¿" }
                ]
            },
            "2": {
                name: "2å·æ¥¼",
                floors: [
                    { id: "2-1", name: "åœ°ä¸‹æ¶ˆé˜²æ³µæˆ¿", description: "æ¶ˆé˜²æ°´æ³µä¸æ§åˆ¶ç³»ç»Ÿ" },
                    { id: "2-2", name: "é—¨å«å®¤", description: "å®‰ä¿è®¾å¤‡ä¸ç›‘æ§" },
                    { id: "2-3", name: "æ¶ˆé˜²å±‹", description: "æ¶ˆé˜²å™¨æå­˜æ”¾" },
                    { id: "2-4", name: "å·¥ç¨‹å±‹", description: "å·¥ç¨‹è®¾å¤‡ä¸å·¥å…·" },
                    { id: "2-5", name: "æ‚ç‰©é—´", description: "æ‚ç‰©å­˜æ”¾" }
                ]
            },
            "3": {
                name: "3å·æ¥¼",
                floors: [
                    { id: "3-1", name: "ä¸€å±‚å¨æˆ¿", description: "å¨æˆ¿è®¾å¤‡ä¸è®¾æ–½" },
                    { id: "3-2", name: "äºŒå±‚é¤å…", description: "å°±é¤åŒºè®¾å¤‡" }
                ]
            },
            "4": {
                name: "4å·æ¥¼",
                floors: [
                    { id: "4-1", name: "ä¸­æ§å®¤", description: "ä¸­å¤®æ§åˆ¶ç³»ç»Ÿ" },
                    { id: "4-2", name: "ç›‘æ§å®¤", description: "ç›‘æ§è®¾å¤‡" },
                    { id: "4-3", name: "é…ç”µå®¤", description: "ç”µåŠ›åˆ†é…è®¾å¤‡" }
                ]
            },
            "5": {
                name: "5å·æ¥¼",
                floors: [
                    { id: "5-1", name: "åº“æˆ¿ä¸ƒ", description: "ç‰©èµ„å­˜å‚¨" },
                    { id: "5-2", name: "åº“æˆ¿å…«", description: "ç‰©èµ„å­˜å‚¨" },
                    { id: "5-3", name: "è§£æå®¤", description: "åˆ†ææ£€æµ‹è®¾å¤‡" }
                ]
            },
            "6": {
                name: "6å·æ¥¼",
                floors: [
                    { id: "6-1", name: "åº“æˆ¿å…­", description: "ç‰©èµ„å­˜å‚¨" },
                    { id: "6-2", name: "å±åºŸé—´", description: "å±é™©åºŸç‰©å­˜æ”¾" },
                    { id: "6-3", name: "é‡‘å±å°é—´", description: "é‡‘å±ææ–™å­˜æ”¾" }
                ]
            },
            "7": {
                name: "7å·æ¥¼",
                floors: [
                    { id: "7-1", name: "äºŒæ¬¡è’¸æ±½å®¤", description: "è’¸æ±½è®¾å¤‡" }
                ]
            },
            "8": {
                name: "8å·æ¥¼",
                floors: [
                    { id: "8-1", name: "è¥¿é—¨å«", description: "å®‰ä¿è®¾æ–½" }
                ]
            },
            "outdoor": {
                name: "å®¤å¤–åŒºåŸŸ",
                floors: [
                    { id: "out-1", name: "å†·å´å¡”", description: "3ä¸ªå·¥ä¸šå†·å´å¡”" },
                    { id: "out-2", name: "è·¯ç¯", description: "å›­åŒºç…§æ˜ç³»ç»Ÿ" },
                    { id: "out-3", name: "æ–°èƒ½æºå……ç”µæ¡©", description: "8ä¸ªè½¦è¾†å……ç”µæ¡©" },
                    { id: "out-4", name: "å‰è½¦å……ç”µåŒº", description: "å‰è½¦åœæ”¾ä¸å……ç”µ" },
                    { id: "out-5", name: "è½¦æ£š", description: "æ‘©æ‰˜è½¦ä¸ç”µåŠ¨è‡ªè¡Œè½¦" }
                ]
            }
        };
        
        // è®¾å¤‡æ•°æ®ç¤ºä¾‹
        let equipmentData = {
            "1-1": [
                {
                    id: "eq-1-1-1",
                    name: "ä¸­å¤®åˆ¶å†·æœºç»„",
                    description: "ä¸»åˆ¶å†·è®¾å¤‡",
                    model: "YCWE-100",
                    parameters: [
                        { name: "å‹å·", value: "YCWE-100" },
                        { name: "åŠŸç‡", value: "380kW" },
                        { name: "åˆ¶å†·å‰‚", value: "R134a" },
                        { name: "é¢å®šç”µæµ", value: "650A" },
                        { name: "åˆ¶é€ å•†", value: "ç‰¹çµ" },
                        { name: "å®‰è£…æ—¥æœŸ", value: "2020-05-15" }
                    ],
                    spareParts: ["å‹ç¼©æœº", "å†·å‡å™¨", "è’¸å‘å™¨", "æ§åˆ¶æ¨¡å—"],
                    maintenanceSchedule: "æ¯å­£åº¦ä¸€æ¬¡",
                    requiredMaterials: ["åˆ¶å†·å‰‚", "æ¶¦æ»‘æ²¹", "è¿‡æ»¤å™¨"],
                    maintenancePersonnel: ["å¼ ä¸‰", "æå››"],
                    maintenanceRecords: [
                        {
                            date: "2023-06-10",
                            person: "å¼ ä¸‰",
                            content: "å¸¸è§„æ£€æŸ¥ï¼Œæ›´æ¢è¿‡æ»¤å™¨ï¼Œè®¾å¤‡è¿è¡Œæ­£å¸¸ã€‚"
                        },
                        {
                            date: "2023-03-15",
                            person: "æå››",
                            content: "å­£åº¦ç»´æŠ¤ï¼Œæ£€æŸ¥åˆ¶å†·å‰‚å‹åŠ›ï¼Œè¡¥å……æ¶¦æ»‘æ²¹ã€‚"
                        }
                    ]
                }
            ]
        };
        
        // ä»æœåŠ¡å™¨åŠ è½½æ•°æ®
        async function loadData() {
            showLoading();
            console.log('æ­£åœ¨ä»æœåŠ¡å™¨åŠ è½½æ•°æ®...');
            try {
                const response = await fetch('/api/data');
                if (response.ok) {
                    const serverData = await response.json();
                    // æ¸…ç©ºç°æœ‰æ•°æ®
                    for (let key in buildingData) {
                        delete buildingData[key];
                    }
                    for (let key in equipmentData) {
                        delete equipmentData[key];
                    }
                    // åŠ è½½æœåŠ¡å™¨æ•°æ®
                    Object.assign(buildingData, serverData.buildingData);
                    Object.assign(equipmentData, serverData.equipmentData);
                    console.log('âœ… ä»æœåŠ¡å™¨åŠ è½½æ•°æ®æˆåŠŸ');
                } else {
                    throw new Error('æœåŠ¡å™¨å“åº”é”™è¯¯: ' + response.status);
                }
            } catch (error) {
                console.log('âŒ æœåŠ¡å™¨è¿æ¥å¤±è´¥:', error.message);
                console.log('ğŸ’¾ å°è¯•ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ•°æ®...');
                
                // å›é€€åˆ°æœ¬åœ°å­˜å‚¨
                const savedBuildingData = localStorage.getItem('buildingData');
                const savedEquipmentData = localStorage.getItem('equipmentData');
                
                if (savedBuildingData) {
                    try {
                        Object.assign(buildingData, JSON.parse(savedBuildingData));
                    } catch (e) {
                        console.error('æœ¬åœ°å»ºç­‘æ•°æ®è§£æå¤±è´¥');
                    }
                }
                if (savedEquipmentData) {
                    try {
                        Object.assign(equipmentData, JSON.parse(savedEquipmentData));
                    } catch (e) {
                        console.error('æœ¬åœ°è®¾å¤‡æ•°æ®è§£æå¤±è´¥');
                    }
                }
            }
            hideLoading();
        }

        // ä¿å­˜æ•°æ®åˆ°æœåŠ¡å™¨
        async function saveData() {
            const data = {
                buildingData: buildingData,
                equipmentData: equipmentData,
                lastUpdate: new Date().toISOString()
            };
            
            try {
                const response = await fetch('/api/data', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json' 
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    console.log('âœ… æ•°æ®ä¿å­˜åˆ°æœåŠ¡å™¨æˆåŠŸ');
                } else {
                    throw new Error(result.message || 'æœåŠ¡å™¨ä¿å­˜å¤±è´¥');
                }
            } catch (error) {
                console.log('âŒ æœåŠ¡å™¨ä¿å­˜å¤±è´¥:', error.message);
                console.log('ğŸ’¾ ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨...');
                
                // å›é€€åˆ°æœ¬åœ°å­˜å‚¨
                try {
                    localStorage.setItem('buildingData', JSON.stringify(buildingData));
                    localStorage.setItem('equipmentData', JSON.stringify(equipmentData));
                    console.log('âœ… æœ¬åœ°å­˜å‚¨ä¿å­˜æˆåŠŸ');
                } catch (localError) {
                    console.error('âŒ æœ¬åœ°å­˜å‚¨ä¹Ÿå¤±è´¥äº†:', localError);
                    alert('æ•°æ®ä¿å­˜å¤±è´¥ï¼è¯·æ£€æŸ¥å­˜å‚¨ç©ºé—´ã€‚');
                }
            }
        }

        // Excelå¯¼å‡ºåŠŸèƒ½
        function exportToExcel() {
            showLoading();
            
            try {
                // å‡†å¤‡æ•°æ®
                const equipmentList = [];
                
                // éå†æ‰€æœ‰è®¾å¤‡
                for (const floorId in equipmentData) {
                    const floorEquipment = equipmentData[floorId];
                    for (const equipment of floorEquipment) {
                        // æ‰¾åˆ°æ¥¼å±‚ä¿¡æ¯
                        let buildingName = '';
                        let floorName = '';
                        
                        for (const buildingId in buildingData) {
                            const building = buildingData[buildingId];
                            const floor = building.floors.find(f => f.id === floorId);
                            if (floor) {
                                buildingName = building.name;
                                floorName = floor.name;
                                break;
                            }
                        }
                        
                        equipmentList.push({
                            'æ¥¼å®‡': buildingName,
                            'æ¥¼å±‚/åŒºåŸŸ': floorName,
                            'è®¾å¤‡åç§°': equipment.name,
                            'è®¾å¤‡æè¿°': equipment.description,
                            'è®¾å¤‡å‹å·': equipment.model,
                            'ç»´æŠ¤å‘¨æœŸ': equipment.maintenanceSchedule,
                            'ç»´æŠ¤äººå‘˜': equipment.maintenancePersonnel ? equipment.maintenancePersonnel.join(', ') : '',
                            'æ‰€éœ€ææ–™': equipment.requiredMaterials ? equipment.requiredMaterials.join(', ') : '',
                            'å¤‡ä»¶æ¸…å•': equipment.spareParts ? equipment.spareParts.join(', ') : '',
                            'ç»´æŠ¤è®°å½•æ•°é‡': equipment.maintenanceRecords ? equipment.maintenanceRecords.length : 0
                        });
                    }
                }
                
                // åˆ›å»ºExcelå·¥ä½œè¡¨
                const ws = XLSX.utils.json_to_sheet(equipmentList);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'è®¾å¤‡æ¸…å•');
                
                // å¯¼å‡ºæ–‡ä»¶
                const fileName = `è®¾å¤‡æ•°æ®å¯¼å‡º_${new Date().toLocaleDateString().replace(/\//g, '-')}.xlsx`;
                XLSX.writeFile(wb, fileName);
                
                console.log('âœ… Excelå¯¼å‡ºæˆåŠŸ');
            } catch (error) {
                console.error('âŒ Excelå¯¼å‡ºå¤±è´¥:', error);
                alert('å¯¼å‡ºå¤±è´¥ï¼š' + error.message);
            }
            
            hideLoading();
        }

        // Excelå¯¼å…¥åŠŸèƒ½
        function importFromExcel(input) {
            const file = input.files[0];
            if (!file) return;
            
            showLoading();
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // è¯»å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    if (confirm(`æ£€æµ‹åˆ° ${jsonData.length} æ¡è®¾å¤‡è®°å½•ï¼Œç¡®è®¤å¯¼å…¥å—ï¼Ÿ`)) {
                        // è¿™é‡Œå¯ä»¥æ·»åŠ Excelæ•°æ®åˆ°ç³»ç»Ÿçš„é€»è¾‘
                        console.log('Excelæ•°æ®:', jsonData);
                        alert('Excelå¯¼å…¥åŠŸèƒ½å¼€å‘ä¸­...');
                    }
                } catch (error) {
                    console.error('Excelå¯¼å…¥å¤±è´¥:', error);
                    alert('å¯¼å…¥å¤±è´¥ï¼š' + error.message);
                }
                
                hideLoading();
                input.value = '';
            };
            
            reader.readAsArrayBuffer(file);
        }

        // JSONå¯¼å‡ºåŠŸèƒ½
        function exportToJSON() {
            showLoading();
            
            try {
                const data = {
                    buildingData: buildingData,
                    equipmentData: equipmentData,
                    exportTime: new Date().toISOString(),
                    version: "1.0"
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `è®¾å¤‡æ•°æ®å¤‡ä»½_${new Date().toLocaleDateString().replace(/\//g, '-')}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                console.log('âœ… JSONå¯¼å‡ºæˆåŠŸ');
            } catch (error) {
                console.error('âŒ JSONå¯¼å‡ºå¤±è´¥:', error);
                alert('å¯¼å‡ºå¤±è´¥ï¼š' + error.message);
            }
            
            hideLoading();
        }

        // JSONå¯¼å…¥åŠŸèƒ½
        function importFromJSON(input) {
            const file = input.files[0];
            if (!file) return;
            
            showLoading();
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (confirm('ç¡®è®¤å¯¼å…¥æ•°æ®ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ‰€æœ‰æ•°æ®ã€‚')) {
                        // æ¸…ç©ºç°æœ‰æ•°æ®
                        for (let key in buildingData) {
                            delete buildingData[key];
                        }
                        for (let key in equipmentData) {
                            delete equipmentData[key];
                        }
                        
                        // å¯¼å…¥æ–°æ•°æ®
                        Object.assign(buildingData, data.buildingData);
                        Object.assign(equipmentData, data.equipmentData);
                        
                        // ä¿å­˜æ•°æ®
                        saveData();
                        alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼é¡µé¢å°†é‡æ–°åŠ è½½ã€‚');
                        location.reload();
                    }
                } catch (error) {
                    console.error('JSONå¯¼å…¥å¤±è´¥:', error);
                    alert('å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯ï¼');
                }
                
                hideLoading();
                input.value = '';
            };
            
            reader.readAsText(file);
        }

        // åŠ è½½çŠ¶æ€æ˜¾ç¤º
        function showLoading() {
            document.getElementById('loading').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
        }

        // å½“å‰é€‰ä¸­çš„æ¥¼å®‡å’Œæ¥¼å±‚ID
        let currentBuildingId = null;
        let currentFloorId = null;
        
        // é¡µé¢å¯¼èˆªå‡½æ•°
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }
        
        function goBack(fromPage, toPage) {
            showPage(toPage);
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            
            // æ¥¼å®‡ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.building-card').forEach(card => {
                card.addEventListener('click', function() {
                    const buildingId = this.getAttribute('data-building');
                    showBuildingFloors(buildingId);
                });
            });
        });

        // æ˜¾ç¤ºæ¥¼å®‡æ¥¼å±‚/åŒºåŸŸ
        function showBuildingFloors(buildingId) {
            const building = buildingData[buildingId];
            if (!building) return;
            
            currentBuildingId = buildingId;
            document.getElementById('building-title').textContent = building.name;
            const floorList = document.getElementById('floor-list');
            floorList.innerHTML = '';
            
            if (building.floors && building.floors.length > 0) {
                building.floors.forEach(floor => {
                    const floorCard = document.createElement('div');
                    floorCard.className = 'floor-card';
                    floorCard.setAttribute('data-floor', floor.id);
                    floorCard.innerHTML = `
                        <div class="floor-name">${floor.name}</div>
                        <div class="floor-desc">${floor.description}</div>
                    `;
                    floorCard.addEventListener('click', function() {
                        showFloorEquipment(floor.id, floor.name);
                    });
                    floorList.appendChild(floorCard);
                });
            } else {
                floorList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ—ï¸</div>
                        <h3>æš‚æ— æ¥¼å±‚/åŒºåŸŸ</h3>
                        <p>è¯¥æ¥¼å®‡å°šæœªæ·»åŠ ä»»ä½•æ¥¼å±‚æˆ–åŒºåŸŸï¼Œç‚¹å‡»"æ·»åŠ æ¥¼å±‚/åŒºåŸŸ"æŒ‰é’®å¼€å§‹æ·»åŠ ã€‚</p>
                    </div>
                `;
            }
            
            showPage('floor-page');
        }
        
        // æ˜¾ç¤ºæ¥¼å±‚è®¾å¤‡
        function showFloorEquipment(floorId, floorName) {
            currentFloorId = floorId;
            document.getElementById('floor-title').textContent = floorName;
            const equipmentList = document.getElementById('equipment-list');
            equipmentList.innerHTML = '';
            
            const equipment = equipmentData[floorId] || [];
            
            if (equipment.length === 0) {
                equipmentList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ”§</div>
                        <h3>æš‚æ— è®¾å¤‡</h3>
                        <p>è¯¥åŒºåŸŸå°šæœªæ·»åŠ ä»»ä½•è®¾å¤‡ï¼Œç‚¹å‡»"æ·»åŠ è®¾å¤‡"æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªè®¾å¤‡ã€‚</p>
                    </div>
                `;
            } else {
                equipment.forEach(item => {
                    const equipmentCard = document.createElement('div');
                    equipmentCard.className = 'equipment-card';
                    equipmentCard.setAttribute('data-equipment', item.id);
                    equipmentCard.innerHTML = `
                        <div class="equipment-name">${item.name}</div>
                        <div class="equipment-desc">${item.description}</div>
                        <div class="equipment-meta">
                            <span>å‹å·: ${item.model || 'æœªçŸ¥'}</span>
                            <span>ç»´æŠ¤: ${item.maintenanceSchedule || 'æœªè®¾ç½®'}</span>
                        </div>
                    `;
                    equipmentCard.addEventListener('click', function() {
                        showEquipmentDetail(item);
                    });
                    equipmentList.appendChild(equipmentCard);
                });
            }
            
            showPage('equipment-page');
        }
        
        // æ˜¾ç¤ºè®¾å¤‡è¯¦æƒ…
        function showEquipmentDetail(equipment) {
            const detailContainer = document.getElementById('equipment-detail');
            
            let parametersHtml = '';
            if (equipment.parameters && equipment.parameters.length > 0) {
                equipment.parameters.forEach(param => {
                    parametersHtml += `
                        <div class="param-item">
                            <span class="param-name">${param.name}:</span>
                            <span>${param.value}</span>
                        </div>
                    `;
                });
            } else {
                parametersHtml = '<p>æš‚æ— å‚æ•°ä¿¡æ¯</p>';
            }
            
            let recordsHtml = '';
            if (equipment.maintenanceRecords && equipment.maintenanceRecords.length > 0) {
                equipment.maintenanceRecords.forEach(record => {
                    recordsHtml += `
                        <div class="maintenance-record">
                            <div class="record-header">
                                <span class="record-date">${record.date}</span>
                                <span class="record-person">ç»´æŠ¤äºº: ${record.person}</span>
                            </div>
                            <div class="record-content">${record.content}</div>
                        </div>
                    `;
                });
            } else {
                recordsHtml = '<p>æš‚æ— ç»´æŠ¤è®°å½•</p>';
            }
            
            detailContainer.innerHTML = `
                <div class="detail-header">
                    <h2 class="detail-title">${equipment.name}</h2>
                    <span class="detail-status">æ­£å¸¸è¿è¡Œ</span>
                </div>
                
                <div class="detail-section">
                    <h3 class="section-title">è®¾å¤‡ä¿¡æ¯</h3>
                    <p>${equipment.description || 'æš‚æ— æè¿°'}</p>
                </div>
                
                <div class="detail-section">
                    <h3 class="section-title">è®¾å¤‡å‚æ•°</h3>
                    <div class="param-grid">
                        ${parametersHtml}
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3 class="section-title">ç»´æŠ¤ä¿¡æ¯</h3>
                    <div class="param-grid">
                        <div class="param-item">
                            <span class="param-name">ç»´æŠ¤å‘¨æœŸ:</span>
                            <span>${equipment.maintenanceSchedule || 'æœªè®¾ç½®'}</span>
                        </div>
                        <div class="param-item">
                            <span class="param-name">æ‰€éœ€ææ–™:</span>
                            <span>${equipment.requiredMaterials ? equipment.requiredMaterials.join(', ') : 'æœªè®¾ç½®'}</span>
                        </div>
                        <div class="param-item">
                            <span class="param-name">ç»´æŠ¤äººå‘˜:</span>
                            <span>${equipment.maintenancePersonnel ? equipment.maintenancePersonnel.join(', ') : 'æœªè®¾ç½®'}</span>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3 class="section-title">å¤‡ä»¶æ¸…å•</h3>
                    <p>${equipment.spareParts ? equipment.spareParts.join(', ') : 'æš‚æ— å¤‡ä»¶ä¿¡æ¯'}</p>
                </div>
                
                <div class="detail-section">
                    <h3 class="section-title">ç»´æŠ¤è®°å½•</h3>
                    ${recordsHtml}
                    <button class="add-record-btn" onclick="openRecordModal('${equipment.id}')">
                        + æ·»åŠ ç»´æŠ¤è®°å½•
                    </button>
                </div>
            `;
            
            showPage('detail-page');
        }
        
        // æ·»åŠ æ¥¼å±‚åŠŸèƒ½
        function openAddFloorModal() {
            document.getElementById('add-floor-modal').style.display = 'flex';
        }
        
        function closeAddFloorModal() {
            document.getElementById('add-floor-modal').style.display = 'none';
            document.getElementById('add-floor-form').reset();
        }
        
        // æäº¤æ·»åŠ æ¥¼å±‚è¡¨å•
        document.getElementById('add-floor-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const floorName = document.getElementById('floor-name').value;
            const floorDescription = document.getElementById('floor-description').value;
            
            // ç”Ÿæˆå”¯ä¸€ID
            const floorId = currentBuildingId + '-' + (buildingData[currentBuildingId].floors.length + 1);
            
            // åˆ›å»ºæ–°æ¥¼å±‚å¯¹è±¡
            const newFloor = {
                id: floorId,
                name: floorName,
                description: floorDescription
            };
            
            // æ·»åŠ åˆ°æ¥¼å®‡æ•°æ®
            if (!buildingData[currentBuildingId].floors) {
                buildingData[currentBuildingId].floors = [];
            }
            buildingData[currentBuildingId].floors.push(newFloor);
            
            // ä¿å­˜æ•°æ®
            saveData();
            
            alert('æ¥¼å±‚/åŒºåŸŸæ·»åŠ æˆåŠŸï¼');
            closeAddFloorModal();
            
            // åˆ·æ–°æ¥¼å±‚åˆ—è¡¨
            const buildingName = document.getElementById('building-title').textContent;
            showBuildingFloors(currentBuildingId);
        });
        
        // æ·»åŠ è®¾å¤‡åŠŸèƒ½
        function openAddEquipmentModal() {
            document.getElementById('add-equipment-modal').style.display = 'flex';
        }
        
        function closeAddEquipmentModal() {
            document.getElementById('add-equipment-modal').style.display = 'none';
            document.getElementById('add-equipment-form').reset();
        }
        
        // æäº¤æ·»åŠ è®¾å¤‡è¡¨å•
        document.getElementById('add-equipment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const equipmentName = document.getElementById('equipment-name').value;
            const equipmentModel = document.getElementById('equipment-model').value;
            const equipmentDescription = document.getElementById('equipment-description').value;
            const equipmentPower = document.getElementById('equipment-power').value;
            const equipmentManufacturer = document.getElementById('equipment-manufacturer').value;
            const equipmentMaintenanceSchedule = document.getElementById('equipment-maintenance-schedule').value;
            
            // ç”Ÿæˆå”¯ä¸€ID
            const equipmentId = 'eq-' + Date.now();
            
            // åˆ›å»ºæ–°è®¾å¤‡å¯¹è±¡
            const newEquipment = {
                id: equipmentId,
                name: equipmentName,
                description: equipmentDescription,
                model: equipmentModel,
                parameters: [
                    { name: "å‹å·", value: equipmentModel },
                    { name: "åŠŸç‡", value: equipmentPower },
                    { name: "åˆ¶é€ å•†", value: equipmentManufacturer }
                ],
                spareParts: [],
                maintenanceSchedule: equipmentMaintenanceSchedule,
                requiredMaterials: [],
                maintenancePersonnel: [],
                maintenanceRecords: []
            };
            
            // æ·»åŠ åˆ°è®¾å¤‡æ•°æ®
            if (!equipmentData[currentFloorId]) {
                equipmentData[currentFloorId] = [];
            }
            equipmentData[currentFloorId].push(newEquipment);
            
            // ä¿å­˜æ•°æ®
            saveData();
            
            alert('è®¾å¤‡æ·»åŠ æˆåŠŸï¼');
            closeAddEquipmentModal();
            
            // åˆ·æ–°è®¾å¤‡åˆ—è¡¨
            const floorName = document.getElementById('floor-title').textContent;
            showFloorEquipment(currentFloorId, floorName);
        });
        
        // ç»´æŠ¤è®°å½•æ¨¡æ€æ¡†
        function openRecordModal(equipmentId) {
            document.getElementById('record-modal').style.display = 'flex';
            document.getElementById('record-form').setAttribute('data-equipment', equipmentId);
            
            // è®¾ç½®é»˜è®¤æ—¥æœŸä¸ºä»Šå¤©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('record-date').value = today;
        }
        
        function closeRecordModal() {
            document.getElementById('record-modal').style.display = 'none';
            document.getElementById('record-form').reset();
        }
        
        // æäº¤ç»´æŠ¤è®°å½•è¡¨å•
        document.getElementById('record-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const equipmentId = this.getAttribute('data-equipment');
            const recordDate = document.getElementById('record-date').value;
            const recordPerson = document.getElementById('record-person').value;
            const recordContent = document.getElementById('record-content').value;
            const nextMaintenance = document.getElementById('next-maintenance').value;
            
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥å°†æ•°æ®å‘é€åˆ°åç«¯ä¿å­˜
            console.log('ä¿å­˜ç»´æŠ¤è®°å½•:', {
                equipmentId,
                recordDate,
                recordPerson,
                recordContent,
                nextMaintenance
            });
            
            alert('ç»´æŠ¤è®°å½•å·²ä¿å­˜ï¼');
            closeRecordModal();
        });
        
        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.addEventListener('click', function(e) {
            const addFloorModal = document.getElementById('add-floor-modal');
            const addEquipmentModal = document.getElementById('add-equipment-modal');
            const recordModal = document.getElementById('record-modal');
            
            if (e.target === addFloorModal) {
                closeAddFloorModal();
            }
            if (e.target === addEquipmentModal) {
                closeAddEquipmentModal();
            }
            if (e.target === recordModal) {
                closeRecordModal();
            }
        });
    </script>
</body>
</html>